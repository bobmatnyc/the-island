---
name: vercel-deployment-platform
description: Vercel serverless deployment platform optimized for Next.js with edge functions, automatic previews, and global CDN. Use when deploying Next.js applications, implementing edge middleware, or setting up CI/CD with automatic preview deployments.
---

# Vercel Deployment Platform Skill

---
progressive_disclosure:
  entry_point:
    summary: "Serverless deployment platform for Next.js, React, and frontend apps with edge functions"
    when_to_use:
      - "When deploying Next.js applications"
      - "When needing edge functions and middleware"
      - "When requiring automatic previews and CI/CD"
      - "When using serverless functions"
    quick_start:
      - "npm install -g vercel"
      - "vercel login"
      - "vercel (in project directory)"
  token_estimate:
    entry: 70-85
    full: 4000-5000
---

## Overview

Vercel is a cloud platform for static sites and serverless functions, optimized for Next.js and frontend frameworks. It provides zero-configuration deployments, automatic HTTPS, edge functions, and global CDN distribution.

**Key Capabilities**:
- Zero-config Next.js deployments
- Edge Functions and Middleware
- Automatic preview deployments
- Serverless Functions (Node.js, Python, Go, Edge)
- Git-based CI/CD workflow
- Global edge network

## Vercel Fundamentals

### Projects and Deployments

**Project Structure**:
```
vercel-app/
├── vercel.json          # Configuration
├── .vercel/             # Local deployment cache
├── public/              # Static assets
├── api/                 # Serverless functions
└── src/                 # Application code
```

**Deployment Environments**:
- **Production**: Main branch deployments (`vercel --prod`)
- **Preview**: Branch and PR deployments (automatic)
- **Development**: Local development (`vercel dev`)

### Authentication and Setup

```bash
# Install Vercel CLI
npm install -g vercel

# Login to Vercel
vercel login

# Link project to Vercel
vercel link

# Deploy to preview
vercel

# Deploy to production
vercel --prod
```

## Next.js Deployment

### App Router Deployment

**next.config.js**:
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'standalone', // Optional: for Docker

  // Image optimization
  images: {
    domains: ['example.com'],
    formats: ['image/avif', 'image/webp'],
  },

  // Experimental features
  experimental: {
    serverActions: true,
  },

  // Headers and redirects
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          { key: 'X-DNS-Prefetch-Control', value: 'on' },
          { key: 'X-Frame-Options', value: 'SAMEORIGIN' },
        ],
      },
    ];
  },
};

module.exports = nextConfig;
```

**App Router Structure**:
```typescript
// app/layout.tsx
export const metadata = {
  title: 'App',
  description: 'Generated by create next app',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}

// app/api/hello/route.ts - Route Handler
export async function GET(request: Request) {
  return Response.json({ message: 'Hello from API' });
}

// app/dashboard/page.tsx - Server Component
export default async function Dashboard() {
  const data = await fetch('https://api.example.com/data', {
    next: { revalidate: 3600 }, // ISR
  });

  return <div>{/* Render data */}</div>;
}
```

### Pages Router Deployment

```typescript
// pages/index.tsx - Static Generation
export async function getStaticProps() {
  return {
    props: { data: 'static' },
    revalidate: 60, // ISR
  };
}

// pages/[id].tsx - Dynamic Routes
export async function getStaticPaths() {
  return {
    paths: [{ params: { id: '1' } }],
    fallback: 'blocking',
  };
}

// pages/api/users.ts - API Route
export default async function handler(req, res) {
  if (req.method === 'GET') {
    res.status(200).json({ users: [] });
  }
}
```

## vercel.json Configuration

### Basic Configuration

```json
{
  "$schema": "https://openapi.vercel.sh/vercel.json",
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "nextjs",

  "functions": {
    "api/**/*.js": {
      "memory": 1024,
      "maxDuration": 10
    }
  },

  "regions": ["iad1", "sfo1"],

  "env": {
    "API_URL": "https://api.example.com"
  },

  "build": {
    "env": {
      "NEXT_PUBLIC_API_KEY": "@api-key"
    }
  }
}
```

### Advanced Configuration

```json
{
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        { "key": "Access-Control-Allow-Origin", "value": "*" },
        { "key": "Access-Control-Allow-Methods", "value": "GET,POST,PUT,DELETE" }
      ]
    }
  ],

  "redirects": [
    {
      "source": "/old-blog/:path*",
      "destination": "/blog/:path*",
      "permanent": true
    }
  ],

  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "https://api.backend.com/:path*"
    }
  ],

  "cleanUrls": true,
  "trailingSlash": false,

  "crons": [
    {
      "path": "/api/cron/cleanup",
      "schedule": "0 0 * * *"
    }
  ]
}
```

## Serverless Functions

### Node.js Functions

```javascript
// api/hello.js
export default function handler(req, res) {
  const { name = 'World' } = req.query;

  res.status(200).json({
    message: `Hello ${name}!`,
    timestamp: new Date().toISOString(),
  });
}

// api/users/[id].js - Dynamic Routes
export default async function handler(req, res) {
  const { id } = req.query;

  if (req.method === 'GET') {
    const user = await fetchUser(id);
    return res.status(200).json(user);
  }

  if (req.method === 'DELETE') {
    await deleteUser(id);
    return res.status(204).end();
  }

  res.status(405).json({ error: 'Method not allowed' });
}
```

### TypeScript Functions

```typescript
// api/typed.ts
import type { VercelRequest, VercelResponse } from '@vercel/node';

interface Data {
  name: string;
  email: string;
}

export default async function handler(
  req: VercelRequest,
  res: VercelResponse<Data>
) {
  const data: Data = {
    name: 'John Doe',
    email: 'john@example.com',
  };

  res.status(200).json(data);
}
```

### Python Functions

```python
# api/python_hello.py
from http.server import BaseHTTPRequestHandler
from datetime import datetime

class handler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'application/json')
        self.end_headers()

        message = {
            'message': 'Hello from Python',
            'timestamp': datetime.now().isoformat()
        }

        self.wfile.write(str(message).encode())
        return
```

### Go Functions

```go
// api/go_hello.go
package handler

import (
    "encoding/json"
    "net/http"
    "time"
)

type Response struct {
    Message   string    `json:"message"`
    Timestamp time.Time `json:"timestamp"`
}

func Handler(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")

    response := Response{
        Message:   "Hello from Go",
        Timestamp: time.Now(),
    }

    json.NewEncoder(w).Encode(response)
}
```

## Edge Functions and Middleware

### Edge Functions

```typescript
// api/edge.ts
export const config = {
  runtime: 'edge',
};

export default async function handler(req: Request) {
  const url = new URL(req.url);
  const country = req.headers.get('x-vercel-ip-country') || 'Unknown';

  return new Response(
    JSON.stringify({
      message: 'Hello from the Edge',
      country,
      path: url.pathname,
    }),
    {
      status: 200,
      headers: {
        'content-type': 'application/json',
      },
    }
  );
}
```

### Next.js Middleware

```typescript
// middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  // Geolocation-based routing
  const country = request.geo?.country || 'US';

  if (country === 'GB') {
    return NextResponse.rewrite(new URL('/gb', request.url));
  }

  // A/B testing
  const bucket = Math.random() < 0.5 ? 'a' : 'b';
  const response = NextResponse.next();
  response.cookies.set('bucket', bucket);

  // Authentication check
  const token = request.cookies.get('token');
  if (!token && request.nextUrl.pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  return response;
}

export const config = {
  matcher: [
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
  ],
};
```

### Edge Middleware Patterns

```typescript
// Rate limiting
import { Ratelimit } from '@upstash/ratelimit';
import { Redis } from '@upstash/redis';

const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(10, '10 s'),
});

export async function middleware(request: NextRequest) {
  const ip = request.ip ?? '127.0.0.1';
  const { success } = await ratelimit.limit(ip);

  if (!success) {
    return new Response('Too Many Requests', { status: 429 });
  }

  return NextResponse.next();
}
```

## Environment Variables

### Setting Environment Variables

```bash
# Via CLI
vercel env add API_KEY production
vercel env add DATABASE_URL preview
vercel env add DEBUG_MODE development

# Pull environment variables
vercel env pull .env.local
```

### Using Environment Variables

```typescript
// Next.js - Public variables (NEXT_PUBLIC_*)
const apiUrl = process.env.NEXT_PUBLIC_API_URL;

// Server-side only
const dbUrl = process.env.DATABASE_URL;
const apiKey = process.env.API_KEY;

// Edge Runtime
export const config = { runtime: 'edge' };

export default function handler(req: Request) {
  // All env vars available at build time
  const secret = process.env.EDGE_SECRET;
  return Response.json({ status: 'ok' });
}
```

### Environment Variable Security

```javascript
// .env.local (never commit)
DATABASE_URL="postgresql://..."
API_SECRET_KEY="secret123"

// .env.production (use Vercel dashboard instead)
# Don't store production secrets in files

// vercel.json - Reference secrets
{
  "env": {
    "PUBLIC_URL": "https://example.com"
  },
  "build": {
    "env": {
      "DATABASE_URL": "@database-url",
      "API_KEY": "@api-key"
    }
  }
}
```

## Framework Support

### React (Vite)

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  build: {
    outDir: 'dist',
  },
});
```

```json
// vercel.json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite"
}
```

### Vue.js

```javascript
// vercel.json for Vue
{
  "framework": "vue",
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "devCommand": "npm run dev"
}
```

### Svelte/SvelteKit

```javascript
// svelte.config.js
import adapter from '@sveltejs/adapter-vercel';

export default {
  kit: {
    adapter: adapter({
      runtime: 'edge', // or 'nodejs18.x'
    }),
  },
};
```

### Static Sites

```json
// vercel.json for static site
{
  "buildCommand": "npm run build",
  "outputDirectory": "build",
  "routes": [
    { "src": "/(.*)", "dest": "/" }
  ]
}
```

## Custom Domains and SSL

### Domain Configuration

```bash
# Add domain via CLI
vercel domains add example.com

# Inspect domain
vercel domains inspect example.com

# Remove domain
vercel domains rm example.com
```

### DNS Configuration

```
# Recommended: CNAME to cname.vercel-dns.com
www.example.com.  CNAME  cname.vercel-dns.com.

# A records (if CNAME not possible)
example.com.      A      76.76.21.21
```

### SSL Certificates

- Automatic SSL via Let's Encrypt
- Auto-renewal before expiration
- Support for wildcard certificates
- Custom certificates (Enterprise)

## Deployment Strategies

### Git Integration

```bash
# Automatic deployments
# - Push to main → Production deployment
# - Push to branch → Preview deployment
# - Open PR → Preview deployment with comments

# Manual control
vercel --prod                    # Force production
vercel --no-clipboard            # Skip URL copy
vercel --force                   # Force rebuild
vercel --archive=tgz             # Download deployment
```

### Preview Deployments

```javascript
// Check if running in preview
const isPreview = process.env.VERCEL_ENV === 'preview';

if (isPreview) {
  // Use preview-specific configuration
  console.log('Preview URL:', process.env.VERCEL_URL);
}

// Available environment variables
process.env.VERCEL_ENV;          // 'production' | 'preview' | 'development'
process.env.VERCEL_URL;          // Deployment URL
process.env.VERCEL_GIT_COMMIT_SHA;
process.env.VERCEL_GIT_COMMIT_MESSAGE;
process.env.VERCEL_GIT_COMMIT_AUTHOR_NAME;
```

### Deployment Protection

```json
// vercel.json
{
  "github": {
    "enabled": true,
    "autoAlias": false,
    "silent": false,
    "autoJobCancelation": true
  }
}
```

## Edge Config and KV Storage

### Edge Config

```typescript
// Install
// npm install @vercel/edge-config

import { get } from '@vercel/edge-config';

export const config = { runtime: 'edge' };

export default async function handler() {
  const featureFlag = await get('feature-flag');

  return Response.json({
    enabled: featureFlag,
  });
}
```

### Vercel KV (Redis)

```typescript
// Install
// npm install @vercel/kv

import { kv } from '@vercel/kv';

export default async function handler(req: Request) {
  // Set value
  await kv.set('user:123', { name: 'John', email: 'john@example.com' });

  // Get value
  const user = await kv.get('user:123');

  // Increment
  await kv.incr('page-views');

  // Expire
  await kv.setex('session:abc', 3600, { userId: '123' });

  return Response.json({ user });
}
```

## Analytics and Monitoring

### Web Analytics

```typescript
// app/layout.tsx
import { Analytics } from '@vercel/analytics/react';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <Analytics />
      </body>
    </html>
  );
}
```

### Speed Insights

```typescript
import { SpeedInsights } from '@vercel/speed-insights/next';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <SpeedInsights />
      </body>
    </html>
  );
}
```

### Log Streaming

```bash
# Stream logs in real-time
vercel logs [deployment-url] --follow

# Filter by function
vercel logs --scope=api/hello

# Production logs
vercel logs --prod
```

## Team Collaboration

### Team Management

```bash
# Create team
vercel teams add my-team

# Switch teams
vercel switch my-team

# List team members
vercel teams list

# Invite member
vercel teams invite user@example.com
```

### Project Settings

```json
// .vercel/project.json
{
  "projectId": "prj_xxx",
  "orgId": "team_xxx",
  "settings": {
    "buildCommand": "npm run build",
    "devCommand": "npm run dev",
    "installCommand": "npm install",
    "framework": "nextjs"
  }
}
```

## Best Practices

### Performance Optimization

```typescript
// 1. Image Optimization
import Image from 'next/image';

<Image
  src="/photo.jpg"
  alt="Photo"
  width={800}
  height={600}
  priority // Above fold
  placeholder="blur"
/>

// 2. Font Optimization
import { Inter } from 'next/font/google';

const inter = Inter({ subsets: ['latin'] });

// 3. Code Splitting
const DynamicComponent = dynamic(() => import('./Component'), {
  loading: () => <p>Loading...</p>,
  ssr: false,
});

// 4. ISR for Dynamic Content
export async function generateStaticParams() {
  return [{ id: '1' }, { id: '2' }];
}

export const revalidate = 3600; // 1 hour
```

### Security Best Practices

```typescript
// 1. Environment Variables
// Never expose secrets to client
const secret = process.env.API_SECRET; // Server only

// 2. CORS Configuration
export default async function handler(req, res) {
  res.setHeader('Access-Control-Allow-Origin', 'https://example.com');
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST');
}

// 3. Rate Limiting (Edge Middleware)
import { Ratelimit } from '@upstash/ratelimit';

// 4. Input Validation
import { z } from 'zod';

const schema = z.object({
  email: z.string().email(),
  age: z.number().min(18),
});
```

### Build Optimization

```javascript
// next.config.js
module.exports = {
  // Reduce bundle size
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },

  // Optimize images
  images: {
    formats: ['image/avif', 'image/webp'],
    minimumCacheTTL: 60,
  },

  // Enable SWC minification
  swcMinify: true,

  // Analyze bundle
  webpack: (config, { isServer }) => {
    if (!isServer) {
      config.optimization.splitChunks.cacheGroups = {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
      };
    }
    return config;
  },
};
```

### Caching Strategies

```typescript
// 1. Static Generation (Build Time)
export async function generateStaticParams() {
  return [{ slug: 'post-1' }, { slug: 'post-2' }];
}

// 2. ISR (Incremental Static Regeneration)
export const revalidate = 3600;

// 3. On-Demand Revalidation
export async function POST(request: Request) {
  const { revalidate } = await import('next/cache');
  revalidate('/blog/[slug]');
  return Response.json({ revalidated: true });
}

// 4. Cache Headers
export async function GET() {
  return new Response('Hello', {
    headers: {
      'Cache-Control': 'public, s-maxage=3600, stale-while-revalidate=86400',
    },
  });
}
```

## Troubleshooting

### Common Issues

```bash
# Build fails
vercel logs [deployment-url] --scope=build

# Function timeout
# Increase maxDuration in vercel.json
{
  "functions": {
    "api/**/*.js": {
      "maxDuration": 60
    }
  }
}

# Environment variables not working
vercel env pull .env.local
vercel env ls

# Clear build cache
vercel --force

# Domain not working
vercel domains inspect example.com
```

### Debug Mode

```bash
# Enable debug logs
DEBUG=* vercel

# Verbose output
vercel --debug

# Local development with production data
vercel dev --listen 3000
```

## Quick Reference

### Essential Commands

```bash
vercel                          # Deploy to preview
vercel --prod                   # Deploy to production
vercel dev                      # Local development
vercel logs [url]              # View logs
vercel env add [name]          # Add environment variable
vercel domains add [domain]    # Add custom domain
vercel alias set [url] [alias] # Set alias
vercel inspect [url]           # Inspect deployment
vercel rollback [url]          # Rollback deployment
```

### Environment Variables (Auto-Injected)

```typescript
process.env.VERCEL              // "1"
process.env.VERCEL_ENV          // "production" | "preview" | "development"
process.env.VERCEL_URL          // Deployment URL
process.env.VERCEL_REGION       // Edge region
process.env.VERCEL_GIT_PROVIDER // "github" | "gitlab" | "bitbucket"
process.env.VERCEL_GIT_REPO_SLUG
process.env.VERCEL_GIT_COMMIT_SHA
process.env.VERCEL_GIT_COMMIT_MESSAGE
```

### Function Limits

| Tier | Duration | Memory | Size |
|------|----------|--------|------|
| Hobby | 10s | 1024 MB | 50 MB |
| Pro | 60s | 3008 MB | 50 MB |
| Enterprise | 900s | 3008 MB | 250 MB |

### Useful Resources

- **Documentation**: https://vercel.com/docs
- **CLI Reference**: https://vercel.com/docs/cli
- **Templates**: https://vercel.com/templates
- **Edge Functions**: https://vercel.com/docs/functions/edge-functions
- **Framework Guides**: https://vercel.com/docs/frameworks
